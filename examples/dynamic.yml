# Traefik Dynamic Configuration Example
# Save as: dynamic.yml

http:
  middlewares:
    # Production SSO Configuration
    sso-bridge-prod:
      plugin:
        sso-bridge:
          secretKey: "Prod8Key"
          cookieName: "SSO_AUTH_TICKET"
          cstTokenName: "cst"
          ssoLoginUrl: "https://sso.yourcompany.com/Login.aspx"
          ticketServiceUrl: "https://sso.yourcompany.com/Ticket.asmx"
          serviceId: "production_service_id"
          cookieDomain: ".yourcompany.com"
          cookieSecure: true

    # Development SSO Configuration
    sso-bridge-dev:
      plugin:
        sso-bridge:
          secretKey: "DevKey88"
          cookieName: "SSO_AUTH_TICKET"
          cstTokenName: "cst"
          ssoLoginUrl: "http://sso.dev.local/Login.aspx"
          ticketServiceUrl: "http://sso.dev.local/Ticket.asmx"
          serviceId: "dev_service_id"
          cookieDomain: ".dev.local"
          cookieSecure: false

  routers:
    # Example: Gitea
    gitea-router:
      rule: "Host(`git.yourcompany.com`)"
      service: gitea-service
      entryPoints:
        - websecure
      middlewares:
        - sso-bridge-prod
      tls: {}

    # Example: Grafana
    grafana-router:
      rule: "Host(`metrics.yourcompany.com`)"
      service: grafana-service
      entryPoints:
        - websecure
      middlewares:
        - sso-bridge-prod
      tls: {}

  services:
    gitea-service:
      loadBalancer:
        servers:
          - url: "http://gitea:3000"

    grafana-service:
      loadBalancer:
        servers:
          - url: "http://grafana:3000"
